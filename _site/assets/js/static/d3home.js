var margin={top:30,right:20,bottom:30,left:50},width=600-margin.left-margin.right,height=270-margin.top-margin.bottom,wrapper=d3.select(".homeGraph"),wrapperWidth=parseInt(wrapper.style("width")),wrapperHeight=parseInt(wrapper.style("height")),height=wrapperHeight-margin.top-margin.bottom,width=wrapperWidth-margin.left-margin.right,parseDate=d3.time.format("%d-%b-%y").parse;bisectDate=d3.bisector(function(t){return t.date}).left;var x=d3.time.scale().range([0,width]),y=d3.scale.linear().range([height,0]),xAxis=d3.svg.axis().scale(x).orient("bottom").ticks(5),yAxis=d3.svg.axis().scale(y).orient("left").ticks(5),valueline=d3.svg.line().x(function(t){return x(t.date)}).y(function(t){return y(t.close)}).interpolate("monotone"),svg=d3.select(".homeGraph").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),lineSvg=svg.append("g"),focus=svg.append("g").style("display","none");d3.csv("/data/homegraph.csv",function(t,e){function a(){var t=x.invert(d3.mouse(this)[0]),a=bisectDate(e,t,1),r=e[a-1],n=e[a],i=t-r.date>n.date-t?n:r;focus.select("circle.y").attr("transform","translate("+x(i.date)+","+y(i.close)+")")}e.forEach(function(t){t.date=parseDate(t.date),t.close=+t.close}),x.domain(d3.extent(e,function(t){return t.date})),y.domain([0,d3.max(e,function(t){return t.close})]),lineSvg.append("path").attr("class","line").attr("d",valueline(e)),areas=lineSvg.append("path"),areaShape=d3.svg.area().x(function(t){return x(t.date)}).y0(function(t){return y(0)}).y1(function(t){return y(t.close)}).interpolate("monotone"),areas.attr("d",areaShape(e)).attr("fill","none").classed("chartarea",!0),svg.append("g").attr("class","x axis").attr("transform","translate(0,"+height+")").call(xAxis),focus.append("circle").classed("y",!0).classed("hover",!0).attr("r",4),svg.append("rect").attr("width",width).attr("height",height).style("fill","none").style("pointer-events","all").on("mouseover",function(){focus.style("display",null)}).on("mouseout",function(){focus.style("display","none")}).on("mousemove",a)});