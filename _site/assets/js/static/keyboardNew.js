var UltimaSynth=function(e){function t(e){m.frequency.value=e,f.frequency.value=e/g,p.gain.value=1,u(e)}function n(e){d(e),p.gain.value=0}function a(e){E.gain.value=e}function s(e){C.gain.value=e}function o(e){w.gain.value=e}function r(e){y=l(e),m.type=y}function c(e){h=l(e),f.type=h}function i(e,t){switch(console.log("the "+e+" control has been set to "+t),e){case"masterVolume":a(t);break;case"oscOneVolume":s(t);break;case"oscTwoVolume":o(t);break;case"oscOneWave":r(t);break;case"oscTwoWave":c(t);break;case"vcoTwoPitch":vcoTwoPitch(t)}}function l(e){var t=parseInt(e);switch(t){case 0:stringWaveValue="sine";break;case 1:stringWaveValue="square";break;case 2:stringWaveValue="sawtooth";break;case 3:stringWaveValue="triangle"}return stringWaveValue}function u(e){targetPitch=Math.floor(e),targetClass="pitchClass"+targetPitch,targetKey=document.getElementsByClassName(targetClass),noQuery.addClass(targetKey[0],"pressed")}function d(e){targetPitch=Math.floor(e),targetClass="pitchClass"+targetPitch,targetKey=document.getElementsByClassName(targetClass),noQuery.removeClass(targetKey[0],"pressed")}var v=new e,g=2,y="sine",h="square",m=v.createOscillator();m.type=y,m.frequency.value=440,m.start(0);var f=v.createOscillator();f.type=h,f.frequency.value=440,f.start(0);var p=v.createGain();p.gain.value=0;var C=v.createGain();C.gain.value=1;var w=v.createGain();w.gain.value=1;var E=v.createGain();E.gain.value=.1,m.connect(C),C.connect(p),f.connect(w),w.connect(p),p.connect(E),E.connect(v.destination);var k={controlChanged:i,noteStart:t,noteEnd:n};return k},UltimaSynthInputs=function(e,t){function n(){m=!0;var e=this.getAttribute("data-pitch");newSynth.noteStart(e)}function a(){if(m){var e=this.getAttribute("data-pitch");newSynth.noteStart(e)}}function s(){if(m){var e=this.getAttribute("data-pitch");newSynth.noteEnd(e)}}function o(){m=!1;var e=this.getAttribute("data-pitch");newSynth.noteEnd(e)}function r(){var e=this.value,t=this.getAttribute("data-controlName");newSynth.controlChanged(t,e)}function c(e){return e.keyCode in f?(e.preventDefault(),void 0):(f[e.keyCode]=!0,"undefined"!=typeof p[e.keyCode]&&(e.preventDefault(),noteValue=p[e.keyCode],newSynth.noteStart(noteValue)),void 0)}function i(e){console.log("key up"),delete f[e.keyCode],"undefined"!=typeof p[e.keyCode]&&(e.preventDefault(),noteValue=p[e.keyCode],newSynth.noteEnd(noteValue))}for(var l=t.getElementsByClassName("synthKey"),u=e.getElementsByClassName("masterVolume"),d=e.getElementsByClassName("oscOneVolume"),v=e.getElementsByClassName("oscTwoVolume"),g=e.getElementsByClassName("oscOneWave"),y=e.getElementsByClassName("oscTwoWave"),h=e.getElementsByClassName("oscTwoPitch"),m=!1,f=[],p={65:"261.63",87:"277.18",83:"293.66",69:"311.13",68:"329.63",70:"349.23",84:"369.99",71:"392.00",89:"415.30",72:"440.00",85:"466.16",74:"493.88",75:"523.25",79:"554.37",76:"587.33",80:"622.25",59:"659.26",186:"698.46",222:"739.99",221:"783.99",220:"830.61"},C=0;C<l.length;C++)l[C].addEventListener("mousedown",n,!1),l[C].addEventListener("mouseover",a,!1),l[C].addEventListener("mouseout",s,!1),l[C].addEventListener("mouseup",o,!1);document.addEventListener("keydown",c,!1),document.addEventListener("keyup",i,!1),u[0].addEventListener("change",r,!1),d[0].addEventListener("change",r,!1),v[0].addEventListener("change",r,!1),g[0].addEventListener("change",r,!1),y[0].addEventListener("change",r,!1),h[0].addEventListener("change",r,!1)},noQuery=function(){function e(e,t){if(e.classList)var n=e.classList.contains(t);else var n=new RegExp("(^| )"+t+"( |$)","gi").test(e.className);return n}function t(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function n(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}var a={hasClass:e,addClass:t,removeClass:n};return a}(),controlsWrapper=document.getElementById("synthControls"),keysWrapper=document.getElementById("synthKeys"),contextClass=window.AudioContext||window.webkitAudioContext;if(contextClass)var newSynth=UltimaSynth(contextClass),newSynthInputs=UltimaSynthInputs(controlsWrapper,keysWrapper);